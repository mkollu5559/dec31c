-- show all distinct date values (ignore time)
SELECT
    CAST(LASTUPDATEDTIMESTAMP AS DATE FORMAT 'MM/DD/YYYY') AS upd_date,
    COUNT(*) AS cnt
FROM VENDOR_CORE_DEV_T.ADH_EVALUATION_MEDICATION
GROUP BY 1
ORDER BY 1;

-- show all distinct raw values
SELECT DISTINCT
    LASTUPDATEDTIMESTAMP
FROM VENDOR_CORE_DEV_T.ADH_EVALUATION_MEDICATION
ORDER BY 1;

-- show distinct normalized dates from mixed formats
SELECT DISTINCT
    CAST(
      CAST(LASTUPDATEDTIMESTAMP AS TIMESTAMP FORMAT 'MM/DD/YYYY HH:MI:SS')
      AS DATE
    ) AS normalized_date
FROM VENDOR_CORE_DEV_T.ADH_EVALUATION_MEDICATION
ORDER BY 1;
