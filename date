SELECT DISTINCT
  LASTUPDATEDTIMESTAMP,
  TO_VARCHAR(LASTUPDATEDTIMESTAMP, 'MM/DD/YYYY HH:MI:SS AM') AS fmt_us
FROM VENDOR_CORE_DEV_T.ADH_EVALUATION_MEDICATION
ORDER BY LASTUPDATEDTIMESTAMP;


SELECT
  LASTUPDATEDTIMESTAMP                                              AS raw_value,

  TO_VARCHAR(LASTUPDATEDTIMESTAMP, 'MM/DD/YYYY HH:MI:SS AM')        AS fmt_us_12h,
  TO_VARCHAR(LASTUPDATEDTIMESTAMP, 'YYYY-MM-DD HH24:MI:SS')         AS fmt_24h,
  TO_VARCHAR(LASTUPDATEDTIMESTAMP, 'YYYY-MM-DD HH24:MI:SS.FF3')     AS fmt_ms,
  TO_VARCHAR(LASTUPDATEDTIMESTAMP, 'YYYY-MM-DD HH24:MI:SS.FF9')     AS fmt_ns,
  TO_VARCHAR(LASTUPDATEDTIMESTAMP, 'YYYYMMDDHH24MISS')              AS fmt_compact,
  TO_VARCHAR(LASTUPDATEDTIMESTAMP, 'YYYY-MM-DD"T"HH24:MI:SS')       AS fmt_iso_like,

  TYPEOF(LASTUPDATEDTIMESTAMP)                                      AS column_type
FROM VENDOR_CORE_DEV_T.ADH_EVALUATION_MEDICATION
ORDER BY LASTUPDATEDTIMESTAMP;




-- show all rows in different formats (Teradata)
SELECT
    LASTUPDATEDTIMESTAMP,
    CAST(LASTUPDATEDTIMESTAMP AS VARCHAR(26))                                      AS v_default,
    CAST(LASTUPDATEDTIMESTAMP AS VARCHAR(26) FORMAT 'MM/DD/YYYY HH:MI:SS')         AS v_us,
    CAST(LASTUPDATEDTIMESTAMP AS VARCHAR(26) FORMAT 'YYYY-MM-DD HH24:MI:SS')       AS v_24h,
    CAST(LASTUPDATEDTIMESTAMP AS VARCHAR(30) FORMAT 'YYYY-MM-DD HH24:MI:SS.SSSSSS')AS v_micro,
    CAST(LASTUPDATEDTIMESTAMP AS VARCHAR(14) FORMAT 'YYYYMMDDHH24MISS')            AS v_compact
FROM VENDOR_CORE_DEV_T.ADH_EVALUATION_MEDICATION
ORDER BY LASTUPDATEDTIMESTAMP;

-- exact column type
HELP COLUMN VENDOR_CORE_DEV_T.ADH_EVALUATION_MEDICATION.LASTUPDATEDTIMESTAMP;

-- verify match
SELECT COUNT(*)
FROM VENDOR_CORE_DEV_T.ADH_EVALUATION_MEDICATION
WHERE LASTUPDATEDTIMESTAMP =
      CAST('01/13/2025 07:47:45' AS TIMESTAMP FORMAT 'MM/DD/YYYY HH:MI:SS');

-- update
UPDATE VENDOR_CORE_DEV_T.ADH_EVALUATION_MEDICATION
SET LASTUPDATEDTIMESTAMP = TIMESTAMP '2025-01-13 07:47:45'
WHERE LASTUPDATEDTIMESTAMP =
      CAST('01/13/2025 07:47:45' AS TIMESTAMP FORMAT 'MM/DD/YYYY HH:MI:SS');
